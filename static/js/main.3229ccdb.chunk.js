(this["webpackJsonptest-task-safedeal-frontend-trainee"]=this["webpackJsonptest-task-safedeal-frontend-trainee"]||[]).push([[0],[,,,,,,,,,,,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(1),o=n.n(a),c=n(8),r=n.n(c),i=(n(16),n(11)),s=n(2),u=(n(17),n(18),n(0));var m=function(){return Object(u.jsx)("footer",{className:"header",children:Object(u.jsx)("h1",{className:"header__title",children:"Test APP"})})},l=(n(20),n(21),o.a.memo((function(e){var t=e.id,n=e.url,a=e.onImageClick;return Object(u.jsx)("img",{src:n,alt:"\u041a\u0430\u0440\u0442\u0438\u043d\u043a\u0430",className:"photo-grid-img",onClick:function(){a(t)},onKeyDown:function(e){"Enter"===e.key&&a(t)},role:"presentation"},t)})));var p=function(e){var t=e.cards,n=e.onImageClick;return Object(u.jsx)("section",{className:"photo-grid",children:t.map((function(e){return Object(u.jsx)(l,{id:e.id,url:e.url,onImageClick:n},e.id)}))})};n(22);var d=function(){return Object(u.jsx)("footer",{className:"footer",children:Object(u.jsx)("p",{className:"footer__text",children:"\xa9 2018-2019-2021"})})},j=(n(23),n(4)),f=n(5),b=o.a.memo((function(e){var t=e.isOpenPopup,n=e.onClose,c=e.isLoadingComment,r=e.onSubmitComment,i=e.currentOriginSizeImage,m=e.comments,l=function(){var e=o.a.useState({}),t=Object(s.a)(e,2),n=t[0],c=t[1],r=o.a.useState({}),i=Object(s.a)(r,2),u=i[0],m=i[1],l=o.a.useState(!1),p=Object(s.a)(l,2),d=p[0],b=p[1],h=Object(a.useCallback)((function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];c(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),m(e),b(t)}),[c,m,b]);return{values:n,errors:u,isValid:d,handleChange:function(e){c(Object(f.a)(Object(f.a)({},n),{},Object(j.a)({},e.target.name,e.target.value))),m(Object(f.a)(Object(f.a)({},u),{},Object(j.a)({},e.target.name,e.target.validationMessage))),b(e.target.closest("form").checkValidity())},resetForm:h}}(),p=l.values,d=l.errors,b=l.isValid,h=l.handleChange,g=l.resetForm;return o.a.useEffect((function(){g()}),[m,g]),Object(u.jsx)("div",{className:"popup ".concat(t&&"popup_opened"),onClick:n,role:"button",tabIndex:"-1","aria-hidden":"true",children:Object(u.jsxs)("div",{className:"popup__container",onClick:function(e){return e.stopPropagation()},role:"complementary",tabIndex:"-1","aria-hidden":"true",children:[Object(u.jsx)("button",{className:"popup__close-button",type:"button",onClick:n}),Object(u.jsx)("img",{className:"popup__img",src:i.url,alt:"\u041a\u0430\u0440\u0442\u0438\u043d\u043a\u0430"}),Object(u.jsx)("div",{className:"popup__comments-container",children:m.map((function(e){return Object(u.jsxs)("div",{className:"popup__comment-container",children:[Object(u.jsx)("p",{className:"popup__comment popup__comment_type_date",children:e.date}),Object(u.jsx)("p",{className:"popup__comment",children:e.text})]},e.id)}))}),Object(u.jsxs)("form",{className:"popup__form",action:"#",noValidate:!0,method:"get",onSubmit:function(e){e.preventDefault(),""!==p.name&&""!==p.comment&&r(p,i.id)},children:[Object(u.jsx)("span",{className:"popup__form-error ".concat(!d.name&&"popup__form-error_hide"),children:d.name||""}),Object(u.jsx)("input",{name:"name",className:"popup__form-input",type:"text",placeholder:"\u0412\u0430\u0448\u0435 \u0438\u043c\u044f",value:p.name||"",onChange:h,required:!0,minLength:"2",maxLength:"200",pattern:"^[\u0430-\u044f\u0451\u0410-\u042f\u0401a-zA-Z0-9-\\s\\-]+$"}),Object(u.jsx)("span",{className:"popup__form-error ".concat(!d.comment&&"popup__form-error_hide"),children:d.comment||""}),Object(u.jsx)("input",{name:"comment",className:"popup__form-input",type:"text",placeholder:"\u0412\u0430\u0448 \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439",value:p.comment||"",onChange:h,required:!0,minLength:"2",maxLength:"200",pattern:"^[\u0430-\u044f\u0451\u0410-\u042f\u0401a-zA-Z0-9-\\s\\-]+$"}),Object(u.jsx)("button",{className:"popup__form-button",type:"submit",disabled:c||!b,children:"".concat(c?"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u044f":"\u041e\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439")})]})]})})}));n(24);var h=function(){return Object(u.jsxs)("div",{className:"preloader",children:[Object(u.jsx)("div",{className:"preloader__img"}),Object(u.jsx)("p",{className:"preloader__text",children:"\u0418\u0434\u0435\u0442 \u043f\u043e\u0438\u0441\u043a \u0444\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u0439..."})]})},g=n(9),O=n(10),_=new(function(){function e(t){var n=t.baseUrl;Object(g.a)(this,e),this._baseurl=n}return Object(O.a)(e,[{key:"getInitialImages",value:function(){return fetch("".concat(this._baseurl),{headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.ok?e.json():Promise.reject(e.json())}))}},{key:"getOriginalSizeImage",value:function(e){return fetch("".concat(this._baseurl,"/").concat(e),{headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.ok?e.json():Promise.reject(e.json())}))}},{key:"setNewComment",value:function(e){var t=e.id,n=e.name,a=e.comment;return fetch("".concat(this._baseurl,"/").concat(t,"/comments"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({name:n,comment:a})}).then((function(e){return e.ok?Promise.resolve("ok"):Promise.reject(e.json())}))}}]),e}())({baseUrl:"https://boiling-refuge-66454.herokuapp.com/images"}),x=function(e){var t=new Date(e),n=t.toLocaleString("default",{day:"numeric",month:"numeric"}),a=t.getFullYear();return"".concat(n,".").concat(a)};var v=function(){var e=o.a.useState([]),t=Object(s.a)(e,2),n=t[0],a=t[1],c=o.a.useState(!1),r=Object(s.a)(c,2),l=r[0],j=r[1],f=o.a.useState(!1),g=Object(s.a)(f,2),O=g[0],v=g[1],y=o.a.useState(!1),N=Object(s.a)(y,2),C=N[0],k=N[1],S=o.a.useState({}),I=Object(s.a)(S,2),w=I[0],L=I[1],P=o.a.useState([]),T=Object(s.a)(P,2),E=T[0],F=T[1];function z(){k(!0),document.addEventListener("keydown",D),document.body.style.overflow="hidden"}function A(){k(!1),document.removeEventListener("keydown",D),document.body.style.overflow="auto"}function D(e){"Escape"===e.key&&A()}return o.a.useEffect((function(){j(!0),_.getInitialImages().then((function(e){a(e)})).catch((function(e){console.log(e)})).finally((function(){return j(!1)}))}),[]),Object(u.jsxs)("div",{className:"page",children:[Object(u.jsx)(m,{}),Object(u.jsx)("main",{className:"content",children:l?Object(u.jsx)(h,{}):Object(u.jsx)(p,{cards:n,isLoading:l,onImageClick:function(e){return e!==w.id?(L({}),_.getOriginalSizeImage(e).then((function(e){L({id:e.id,url:e.url});var t=e.comments.map((function(e){return{text:e.text,date:x(e.date),id:e.id}}));F(t),z()})).catch((function(e){return console.log(e)}))):(z(),!0)}})}),Object(u.jsx)(d,{}),Object(u.jsx)(b,{isOpenPopup:C,onClose:A,isLoadingComment:O,onSubmitComment:function(e,t){return v(!0),_.setNewComment({id:t,name:e.name,comment:e.comment}).then((function(){var t={id:Math.random(),text:e.comment,date:x((new Date).getTime())};F([].concat(Object(i.a)(E),[t]))})).catch((function(e){return console.log(e)})).finally((function(){return v(!1)}))},comments:E,currentOriginSizeImage:w})]})},y=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,26)).then((function(t){var n=t.getCLS,a=t.getFID,o=t.getFCP,c=t.getLCP,r=t.getTTFB;n(e),a(e),o(e),c(e),r(e)}))};r.a.render(Object(u.jsx)(o.a.StrictMode,{children:Object(u.jsx)(v,{})}),document.getElementById("root")),y()}],[[25,1,2]]]);
//# sourceMappingURL=main.3229ccdb.chunk.js.map